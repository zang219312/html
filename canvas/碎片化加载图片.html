<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>使用canvas碎片化加载图片</title>
</head>
<body>
<canvas
  id="myCanvas"
  width="900"
  height="600"
  style="background-color: black;"
></canvas>
<script>
  let image = new Image();
  image.src = 'https://cdn.pixabay.com/photo/2022/12/04/10/13/snow-7634083_960_720.jpg'
  let canvas = document.getElementById("myCanvas");
  let context = canvas.getContext("2d");
  let boxWidth, boxHeight;
  let rows = 10,
    columns = 20,
    counter = 0;

  image.onload = function () {
    boxWidth = image.width / columns;
    boxHeight = image.height / rows;
    requestAnimationFrame(animate);
  };

  function animate() {
    let x = Math.floor(Math.random() * columns);
    let y = Math.floor(Math.random() * rows);
    context.drawImage(
      image,
      x * boxWidth, // 横坐标起始位置
      y * boxHeight, // 纵坐标起始位置
      boxWidth, // 图像的宽
      boxHeight, // 图像的高
      x * boxWidth, // 在画布上放置图像的 x 坐标位置
      y * boxHeight, // 在画布上放置图像的 y 坐标位置
      boxWidth, // 要使用的图像的宽度
      boxHeight // 要使用的图像的高度
    );
    counter++;
    if (counter > columns * rows * 0.9) {
      context.drawImage(image, 0, 0);
    } else {
      requestAnimationFrame(animate);
    }
  }
</script>
</body>
</html>



