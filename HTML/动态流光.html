作者：嘟嘟MD
链接：https://zhuanlan.zhihu.com/p/383304490
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

<!DOCTYPE html>
<html lang="en">

<head>
  <title>three.js webgl - mirror</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <link type="text/css" rel="stylesheet" href="main.css">
  <style>
    html,
    body {
      height: 100%;
      width: 100%;
    }
  </style>
</head>

<body>
  <div id="container" style="width:100%;height:100vh;position:relative; overflow: hidden;"></div>
  </div>
  <script type="module">
    import * as THREE from '../build/three.module.js';
    import { OrbitControls } from './jsm/controls/OrbitControls.js';
    let renderer, camera, scene, light, controls;
    const Dom = document.querySelector('#container');
    const width = Dom.clientWidth, height = Dom.clientHeight;
    /**
     * @description 初始化渲染场景
     */
    function initRenderer () {
      renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(width, height);
      const containerDom = document.querySelector('#container');
      containerDom.appendChild(renderer.domElement);
    }
    /**
     * @description 初始化相机
     */
    function initCamera () {
      camera = new THREE.PerspectiveCamera(45, width / height, 1, 10000);
      camera.position.set(5, - 20, 200);
      camera.lookAt(0, 3, 0);
      window.camera = camera;
    }
    /**
     * @description 初始化场景
     */
    function initScene () {
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x020924);
      scene.fog = new THREE.Fog(0x020924, 200, 1000);
      window.scene = scene;
    }
    /**
     * 初始化用户交互
     **/
    function initControls () {
      controls = new OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.enableZoom = true;
      controls.autoRotate = false;
      controls.autoRotateSpeed = 2;
      controls.enablePan = true;
    }
    /**
     * @description 初始化光
     */
    function initLight () {
      const ambientLight = new THREE.AmbientLight(0xcccccc, 1.1);
      scene.add(ambientLight);
      var directionalLight = new THREE.DirectionalLight(0xffffff, 0.2);
      directionalLight.position.set(1, 0.1, 0).normalize();
      var directionalLight2 = new THREE.DirectionalLight(0xff2ffff, 0.2);
      directionalLight2.position.set(1, 0.1, 0.1).normalize();
      scene.add(directionalLight);
      scene.add(directionalLight2);
      var hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.2);
      hemiLight.position.set(0, 1, 0);
      scene.add(hemiLight);
      var directionalLight = new THREE.DirectionalLight(0xffffff);
      directionalLight.position.set(1, 500, - 20);
      directionalLight.castShadow = true;
      directionalLight.shadow.camera.top = 18;
      directionalLight.shadow.camera.bottom = - 10;
      directionalLight.shadow.camera.left = - 52;
      directionalLight.shadow.camera.right = 12;
      scene.add(directionalLight);
    }
    /**
     * 窗口变动
     **/
    function onWindowResize () {
      camera.aspect = innerWidth / innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(innerWidth, innerHeight);
      renders();
    }

    /**
     * @description 渲染
     */
    function renders () {
      renderer.clear();
      renderer.render(scene, camera);
    }

    /**
     * 更新
     **/
    function animate () {
      window.requestAnimationFrame(() => {
        if (controls) controls.update();
        renders();
        animate();
      });
    }

    window.onload = () => {
      initRenderer();
      initCamera();
      initScene();
      initLight();
      initControls();
      animate();
      window.addEventListener('resize', onWindowResize, false);
    };
  </script>
</body>

</html>